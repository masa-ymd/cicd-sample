# フロントエンドロールバックワークフロー

このドキュメントは、GitHub Actionsワークフローを使用してフロントエンドのデプロイメントを手動でロールバックする方法を説明します。

## 概要

ロールバックワークフローは主に2つのアクションを実行します：
1. S3オブジェクトを以前のバージョンに戻す
2. CloudFrontキャッシュを無効化し、ロールバックされたバージョンがユーザーに提供されるようにする

## 使用するタイミング

このワークフローは以下の場合に使用してください：
- 本番環境へのデプロイメントで重大なバグが発生した場合
- 以前の正常に動作していたバージョンに素早く戻す必要がある場合
- 通常のデプロイ手順では問題を修正するのに時間がかかりすぎる場合

## 前提条件

- ワークフローをトリガーする権限を持つGitHubアクセス
- フロントエンドバケットでS3バージョニングが有効になっていること

## ロールバックの実行方法

1. GitHubリポジトリのActionsタブに移動
2. リストから「Frontend Manual Rollback (Production)」または「Frontend Manual Rollback (Development)」ワークフローを選択
3. 「Run workflow」をクリック
4. パラメータを入力：
   - **ロールバックするバージョン**: 前のバージョンにロールバックする場合は空欄、特定のS3バージョンIDを指定する場合は入力
   - **ロールバック確認**: ロールバックを実行するには「CONFIRM」（大文字）と入力
5. 「Run workflow」をクリックしてロールバックプロセスを開始

## 検証方法

ワークフローが完了したら：
1. ワークフロー実行ログを確認し、すべてのオブジェクトが正常にロールバックされたことを確認
2. 本番/開発環境のURLにアクセスしてフロントエンドアプリケーションを確認
3. 重要な機能をテストして期待通りに動作することを確認

## トラブルシューティング

- ロールバックが失敗した場合、ワークフローログで具体的なエラーメッセージを確認
- AWS認証情報が正しく設定されていることを確認
- S3バケットでバージョニングが有効になっていることを確認
- CloudFrontの無効化が失敗した場合、AWSコンソールで手動で無効化を作成可能 